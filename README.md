# 微软客户 POE 文档生成器 - 使用指南

欢迎使用微软客户 POE 文档生成器。这是一个基于 Azure OpenAI 驱动的一站式售前自动化工具，旨在帮助技术和销售团队一键生成客户解决方案架构文档、POV 测试部署计划、重绘现代化的架构图，并处理繁杂的 Azure Migrate 算力评估 Excel 转换。

## 一、 系统要求与准备

在启动前，请确保项目的 `templates/` 目录下放置了以下必须的参考模板文件，系统会基于这些模板的风格生成对应的输出：
- `solution_template.docx.docx` (解决方案架构参考模板)
- `pov_template.docx` (POV 部署计划参考模板)
- `AzureMigrateimporttemplate.csv` (Azure Migrate CSV 官方表头模板)

启动系统：
```bash
python3 -m streamlit run app.py
```

---

## 二、 四步标准工作流

### 第 1 步：全局信息录入 (金主爸爸信息录入)
所有的生成操作前，必须在页面主区域顶部填写客户的基础信息：
- **客户尊称 (必填)**：例如“Contoso 限公司”。
- **预估年消耗 (USD)**：填入预估的 Azure 消耗金额（如 `$50k+` 或 `$500k`）。**提示**：系统会根据这个预算额度动态分配架构中的大模型型号，高预算会配给 o1 或 o3-mini 模型，普通预算则使用 GPT-4o 系列。
- **前线战报 (客户背景信息)**：将客户的行业背景、现有 IT 情况痛点及核心诉求写在这里，信息越丰富，后续生成的架构越贴合场景。

### 第 2 步：生成解决方案文档 (Tab 1: AI 解决方案文档)
本步骤是整个工具的核心基石。后续的 POV 计划、架构图均依赖这里的输出。
1. 在“AI 解决方案文档”标签页内，点击 **[召唤神龙 (生成解决方案文档)]** 按钮。
2. AI 将自动推演业务背景需求，并在右侧实时预览生成的 Markdown 方案。
3. 确认内容无误后，点击左侧的 **[疯狂输出 (下载解决方案 .docx)]**，即可获取排版完整的 Word 原件。

### 第 3 步：生成 POV 部署计划 (Tab 2: POV 部署计划)
1. 切换至“POV 部署计划”标签。
2. 选择本项目的 **POV 开始与结束日期**。
3. 如果需要，可在输入框内修改**乙方项目人员名单（我们的人员）**。系统会根据步骤 1 的公司背景自动编排合理的甲方客户对接人角色。
4. 点击 **[安排得明明白白 (生成 POV 计划)]**。
5. 在左下方点击 **[拿去糊弄甲方 (下载 POV .docx)]** 即可下载排版后的测试计划文档。

### 第 4 步：绘制高颜值架构图 (Tab 3: 架构图 SVG)
无需打开 PPT 一点点画线，AI 会将当前架构转为精准矢量图。
1. 切换至“架构图 (SVG)”标签。
2. 点击 **[灵魂画手附体 (生成架构图)]** 按钮。系统会采用硬性网格布局和 Z-Index 图层隔离技术，生成具有阴影和渐变的架构图。
3. 页面将直接渲染出精美的预览。
4. 两种提取方式：点击 **[保存这稀世珍宝 (下载 SVG)]** 以文件保存，或展开底部的“查看 SVG 代码”面板，通过一键**复制按钮**将代码导入到 Draw.io 或 Excalidraw 等作图工具中二次标注。

---

## 三、 特殊功能：Azure Migrate 评估表转换 (Tab 4)
当遇到客户提供复杂的传统服务器价格估算表（Excel）时使用：
1. 切换至“Azure Migrate CSV”。
2. 上传带有资源明细与估价的 **Excel 文件 (.xlsx)**。
3. 点击 **[变魔术！(生成 Azure Migrate CSV)]**。AI 会提取所有 Sheet 中的数据，自动推演对应本地环境的 CPU 核数、内存大小和磁盘 IOPS。
4. 点击 **[拿去交差 (下载 Azure Migrate CSV)]**，获得符合 Azure 标准导入格式的 CSV 表文件。

## 四、 其他操作

**清理历史工作状态：**
为不同客户生成内容时，切记点击左侧菜单栏下方的 **[一键毁灭证据 (清除所有结果)]** 按钮。这会清空当前缓存的所有背景和结果，避免上一个客户的信息串台到新客户的报告中。
